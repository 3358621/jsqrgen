!function(r,e){function t(r,e){for(i in e)i in r||(r[i]=e[i])}function n(r){var e=this;e.cellSize=r.cellSize||r.tileWidth||r.tileHeight,e.size=r.size||r.width||r.height||256,e.typeNumber=r.typeNumber||4,e.correctLevel=r.correctLevel||"M",e.colorDark=r.colorDark||"black",e.colorLight=r.colorLight||"white",e.data=r.data||"",e.image=r.image||{},e.image.tagName&&(e.image={dom:e.image}),t(e.image,{clearEdges:!0}),e.effect=r.effect||{},e.make()}e["true"]=r;var o=function(){function r(e,t){if("undefined"==typeof e.length)throw new Error(e.length+"/"+t);var n=function(){for(var r=0;r<e.length&&0==e[r];)r+=1;for(var n=new Array(e.length-r+t),o=0;o<e.length-r;o+=1)n[o]=e[o+r];return n}(),o={};return o.getAt=function(r){return n[r]},o.getLength=function(){return n.length},o.multiply=function(e){for(var t=new Array(o.getLength()+e.getLength()-1),n=0;n<o.getLength();n+=1)for(var a=0;a<e.getLength();a+=1)t[n+a]^=i.gexp(i.glog(o.getAt(n))+i.glog(e.getAt(a)));return r(t,0)},o.mod=function(e){if(o.getLength()-e.getLength()<0)return o;for(var t=i.glog(o.getAt(0))-i.glog(e.getAt(0)),n=new Array(o.getLength()),a=0;a<o.getLength();a+=1)n[a]=o.getAt(a);for(var a=0;a<e.getLength();a+=1)n[a]^=i.gexp(i.glog(e.getAt(a))+t);return r(n,0).mod(e)},o}var e=function(e,t){var o=236,i=17,c=e,g=n[t],h=null,s=0,v=null,d=new Array,m={},w=function(r,e){s=4*c+17,h=function(r){for(var e=new Array(r),t=0;r>t;t+=1){e[t]=new Array(r);for(var n=0;r>n;n+=1)e[t][n]=null}return e}(s),T(0,0),T(s-7,0),T(0,s-7),E(),D(),y(r,e),c>=7&&k(r),null==v&&(v=L(c,g,d)),A(v,e)},T=function(r,e){for(var t=-1;7>=t;t+=1)if(!(-1>=r+t||r+t>=s))for(var n=-1;7>=n;n+=1)-1>=e+n||e+n>=s||(h[r+t][e+n]=t>=0&&6>=t&&(0==n||6==n)||n>=0&&6>=n&&(0==t||6==t)||t>=2&&4>=t&&n>=2&&4>=n?!0:!1)},p=function(){for(var r=0,e=0,t=0;8>t;t+=1){w(!0,t);var n=a.getLostPoint(m);(0==t||r>n)&&(r=n,e=t)}return e},D=function(){for(var r=8;s-8>r;r+=1)null==h[r][6]&&(h[r][6]=r%2==0);for(var e=8;s-8>e;e+=1)null==h[6][e]&&(h[6][e]=e%2==0)},E=function(){for(var r=a.getPatternPosition(c),e=0;e<r.length;e+=1)for(var t=0;t<r.length;t+=1){var n=r[e],o=r[t];if(null==h[n][o])for(var i=-2;2>=i;i+=1)for(var u=-2;2>=u;u+=1)h[n+i][o+u]=-2==i||2==i||-2==u||2==u||0==i&&0==u?!0:!1}},k=function(r){for(var e=a.getBCHTypeNumber(c),t=0;18>t;t+=1){var n=!r&&1==(e>>t&1);h[Math.floor(t/3)][t%3+s-8-3]=n}for(var t=0;18>t;t+=1){var n=!r&&1==(e>>t&1);h[t%3+s-8-3][Math.floor(t/3)]=n}},y=function(r,e){for(var t=g<<3|e,n=a.getBCHTypeInfo(t),o=0;15>o;o+=1){var i=!r&&1==(n>>o&1);6>o?h[o][8]=i:8>o?h[o+1][8]=i:h[s-15+o][8]=i}for(var o=0;15>o;o+=1){var i=!r&&1==(n>>o&1);8>o?h[8][s-o-1]=i:9>o?h[8][15-o-1+1]=i:h[8][15-o-1]=i}h[s-8][8]=!r},A=function(r,e){for(var t=-1,n=s-1,o=7,i=0,u=a.getMaskFunction(e),f=s-1;f>0;f-=2)for(6==f&&(f-=1);;){for(var l=0;2>l;l+=1)if(null==h[n][f-l]){var c=!1;i<r.length&&(c=1==(r[i]>>>o&1));var g=u(n,f-l);g&&(c=!c),h[n][f-l]=c,o-=1,-1==o&&(i+=1,o=7)}if(n+=t,0>n||n>=s){n-=t,t=-t;break}}},M=function(e,t){for(var n=0,o=0,i=0,u=new Array(t.length),f=new Array(t.length),l=0;l<t.length;l+=1){var c=t[l].dataCount,g=t[l].totalCount-c;o=Math.max(o,c),i=Math.max(i,g),u[l]=new Array(c);for(var h=0;h<u[l].length;h+=1)u[l][h]=255&e.getBuffer()[h+n];n+=c;var s=a.getErrorCorrectPolynomial(g),v=r(u[l],s.getLength()-1),d=v.mod(s);f[l]=new Array(s.getLength()-1);for(var h=0;h<f[l].length;h+=1){var m=h+d.getLength()-f[l].length;f[l][h]=m>=0?d.getAt(m):0}}for(var w=0,h=0;h<t.length;h+=1)w+=t[h].totalCount;for(var T=new Array(w),p=0,h=0;o>h;h+=1)for(var l=0;l<t.length;l+=1)h<u[l].length&&(T[p]=u[l][h],p+=1);for(var h=0;i>h;h+=1)for(var l=0;l<t.length;l+=1)h<f[l].length&&(T[p]=f[l][h],p+=1);return T},L=function(r,e,t){for(var n=u.getRSBlocks(r,e),l=f(),c=0;c<t.length;c+=1){var g=t[c];l.put(g.getMode(),4),l.put(g.getLength(),a.getLengthInBits(g.getMode(),r)),g.write(l)}for(var h=0,c=0;c<n.length;c+=1)h+=n[c].dataCount;if(l.getLengthInBits()>8*h)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*h+")");for(l.getLengthInBits()+4<=8*h&&l.put(0,4);l.getLengthInBits()%8!=0;)l.putBit(!1);for(;;){if(l.getLengthInBits()>=8*h)break;if(l.put(o,8),l.getLengthInBits()>=8*h)break;l.put(i,8)}return M(l,n)};return m.addData=function(r){var e=l(r);d.push(e),v=null},m.isDark=function(r,e){if(0>r||r>=s||0>e||e>=s)throw new Error(r+","+e);return h[r][e]},m.getModuleCount=function(){return s},m.make=function(){w(!1,p())},m.createTableTag=function(r,e){r=r||2,e="undefined"==typeof e?4*r:e;var t="";t+='<table style="',t+=" border-width: 0px; border-style: none;",t+=" border-collapse: collapse;",t+=" padding: 0px; margin: "+e+"px;",t+='">',t+="<tbody>";for(var n=0;n<m.getModuleCount();n+=1){t+="<tr>";for(var o=0;o<m.getModuleCount();o+=1)t+='<td style="',t+=" border-width: 0px; border-style: none;",t+=" border-collapse: collapse;",t+=" padding: 0px; margin: 0px;",t+=" width: "+r+"px;",t+=" height: "+r+"px;",t+=" background-color: ",t+=m.isDark(n,o)?"#000000":"#ffffff",t+=";",t+='"/>';t+="</tr>"}return t+="</tbody>",t+="</table>"},m.createImgTag=function(r,e){r=r||2,e="undefined"==typeof e?4*r:e;var t=m.getModuleCount()*r+2*e,n=e,o=t-e;return createImgTag(t,t,function(e,t){if(e>=n&&o>e&&t>=n&&o>t){var a=Math.floor((e-n)/r),i=Math.floor((t-n)/r);return m.isDark(i,a)?0:1}return 1})},m};e.stringToBytes=function(r){for(var e=new Array,t=0;t<r.length;t+=1){var n=r.charCodeAt(t);e.push(255&n)}return e},e.createStringToBytes=function(r,e){var t=function(){for(var t=base64DecodeInputStream(r),n=function(){var r=t.read();if(-1==r)throw new Error;return r},o=0,a={};;){var i=t.read();if(-1==i)break;var u=n(),f=n(),l=n(),c=String.fromCharCode(i<<8|u),g=f<<8|l;a[c]=g,o+=1}if(o!=e)throw new Error(o+" != "+e);return a}(),n="?".charCodeAt(0);return function(r){for(var e=new Array,o=0;o<r.length;o+=1){var a=r.charCodeAt(o);if(128>a)e.push(a);else{var i=t[r.charAt(o)];"number"==typeof i?(255&i)==i?e.push(i):(e.push(i>>>8),e.push(255&i)):e.push(n)}}return e}};var t={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},n={L:1,M:0,Q:3,H:2},o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a=function(){var e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,a=7973,u=21522,f={},l=function(r){for(var e=0;0!=r;)e+=1,r>>>=1;return e};return f.getBCHTypeInfo=function(r){for(var e=r<<10;l(e)-l(n)>=0;)e^=n<<l(e)-l(n);return(r<<10|e)^u},f.getBCHTypeNumber=function(r){for(var e=r<<12;l(e)-l(a)>=0;)e^=a<<l(e)-l(a);return r<<12|e},f.getPatternPosition=function(r){return e[r-1]},f.getMaskFunction=function(r){switch(r){case o.PATTERN000:return function(r,e){return(r+e)%2==0};case o.PATTERN001:return function(r){return r%2==0};case o.PATTERN010:return function(r,e){return e%3==0};case o.PATTERN011:return function(r,e){return(r+e)%3==0};case o.PATTERN100:return function(r,e){return(Math.floor(r/2)+Math.floor(e/3))%2==0};case o.PATTERN101:return function(r,e){return r*e%2+r*e%3==0};case o.PATTERN110:return function(r,e){return(r*e%2+r*e%3)%2==0};case o.PATTERN111:return function(r,e){return(r*e%3+(r+e)%2)%2==0};default:throw new Error("bad maskPattern:"+r)}},f.getErrorCorrectPolynomial=function(e){for(var t=r([1],0),n=0;e>n;n+=1)t=t.multiply(r([1,i.gexp(n)],0));return t},f.getLengthInBits=function(r,e){if(e>=1&&10>e)switch(r){case t.MODE_NUMBER:return 10;case t.MODE_ALPHA_NUM:return 9;case t.MODE_8BIT_BYTE:return 8;case t.MODE_KANJI:return 8;default:throw new Error("mode:"+r)}else if(27>e)switch(r){case t.MODE_NUMBER:return 12;case t.MODE_ALPHA_NUM:return 11;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 10;default:throw new Error("mode:"+r)}else{if(!(41>e))throw new Error("type:"+e);switch(r){case t.MODE_NUMBER:return 14;case t.MODE_ALPHA_NUM:return 13;case t.MODE_8BIT_BYTE:return 16;case t.MODE_KANJI:return 12;default:throw new Error("mode:"+r)}}},f.getLostPoint=function(r){for(var e=r.getModuleCount(),t=0,n=0;e>n;n+=1)for(var o=0;e>o;o+=1){for(var a=0,i=r.isDark(n,o),u=-1;1>=u;u+=1)if(!(0>n+u||n+u>=e))for(var f=-1;1>=f;f+=1)0>o+f||o+f>=e||(0!=u||0!=f)&&i==r.isDark(n+u,o+f)&&(a+=1);a>5&&(t+=3+a-5)}for(var n=0;e-1>n;n+=1)for(var o=0;e-1>o;o+=1){var l=0;r.isDark(n,o)&&(l+=1),r.isDark(n+1,o)&&(l+=1),r.isDark(n,o+1)&&(l+=1),r.isDark(n+1,o+1)&&(l+=1),(0==l||4==l)&&(t+=3)}for(var n=0;e>n;n+=1)for(var o=0;e-6>o;o+=1)r.isDark(n,o)&&!r.isDark(n,o+1)&&r.isDark(n,o+2)&&r.isDark(n,o+3)&&r.isDark(n,o+4)&&!r.isDark(n,o+5)&&r.isDark(n,o+6)&&(t+=40);for(var o=0;e>o;o+=1)for(var n=0;e-6>n;n+=1)r.isDark(n,o)&&!r.isDark(n+1,o)&&r.isDark(n+2,o)&&r.isDark(n+3,o)&&r.isDark(n+4,o)&&!r.isDark(n+5,o)&&r.isDark(n+6,o)&&(t+=40);for(var c=0,o=0;e>o;o+=1)for(var n=0;e>n;n+=1)r.isDark(n,o)&&(c+=1);var g=Math.abs(100*c/e/e-50)/5;return t+=10*g},f}(),i=function(){for(var r=new Array(256),e=new Array(256),t=0;8>t;t+=1)r[t]=1<<t;for(var t=8;256>t;t+=1)r[t]=r[t-4]^r[t-5]^r[t-6]^r[t-8];for(var t=0;255>t;t+=1)e[r[t]]=t;var n={};return n.glog=function(r){if(1>r)throw new Error("glog("+r+")");return e[r]},n.gexp=function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return r[e]},n}(),u=function(){var r=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16]],e=function(r,e){var t={};return t.totalCount=r,t.dataCount=e,t},t={},o=function(e,t){switch(t){case n.L:return r[4*(e-1)+0];case n.M:return r[4*(e-1)+1];case n.Q:return r[4*(e-1)+2];case n.H:return r[4*(e-1)+3];default:return void 0}};return t.getRSBlocks=function(r,t){var n=o(r,t);if("undefined"==typeof n)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+t);for(var a=n.length/3,i=new Array,u=0;a>u;u+=1)for(var f=n[3*u+0],l=n[3*u+1],c=n[3*u+2],g=0;f>g;g+=1)i.push(e(l,c));return i},t}(),f=function(){var r=new Array,e=0,t={};return t.getBuffer=function(){return r},t.getAt=function(e){var t=Math.floor(e/8);return 1==(r[t]>>>7-e%8&1)},t.put=function(r,e){for(var n=0;e>n;n+=1)t.putBit(1==(r>>>e-n-1&1))},t.getLengthInBits=function(){return e},t.putBit=function(t){var n=Math.floor(e/8);r.length<=n&&r.push(0),t&&(r[n]|=128>>>e%8),e+=1},t},l=function(r){var n=t.MODE_8BIT_BYTE,o=e.stringToBytes(r),a={};return a.getMode=function(){return n},a.getLength=function(){return o.length},a.write=function(r){for(var e=0;e<o.length;e+=1)r.put(o[e],8)},a};return e}();n.prototype={make:function(){var r=this;r.image.dom&&(r.correctLevel="H"),r.qrcode=o(r.typeNumber,r.correctLevel),r.qrcode.addData(r.data),r.qrcode.make(),r.count=r.qrcode.getModuleCount(),r.cellSize?r.size=r.cellSize*r.count:r.cellSize=r.size/r.count,r.prepareImage(),r.canvas=document.createElement("canvas"),r.canvas.width=r.canvas.height=r.size,r.context=r.canvas.getContext("2d"),r.draw()},getColor:function(r,e,t){return"function"==typeof r?r(this.count,e,t):r},getTile:function(r,e){var t=this;return{row:r,col:e,x:Math.round(e*t.cellSize),y:Math.round(r*t.cellSize),width:Math.ceil((e+1)*t.cellSize)-Math.floor(e*t.cellSize),height:Math.ceil((r+1)*t.cellSize)-Math.floor(r*t.cellSize)}},findTile:function(r,e){var t=this;return{row:Math.floor(e/t.cellSize),col:Math.floor(r/t.cellSize)}},prepareImage:function(){var r,e=.3,t=this,n=t.image.dom;n&&(r=n.clientWidth,r/t.size>e&&(r=t.size*e),t.image.width=r,r=n.clientHeight,r/t.size>e&&(r=t.size*e),t.image.height=r,t.image.x=(t.size-t.image.width)/2,t.image.y=(t.size-t.image.height)/2,t.image.outX=t.image.x-2,t.image.outY=t.image.y-2,t.image.outWidth=t.image.width+4,t.image.outHeight=t.image.height+4,t.image.clearEdges&&(t.image.cell1=t.findTile(t.image.outX,t.image.outY),t.image.cell2=t.findTile(t.image.outX+t.image.outWidth,t.image.outY+t.image.outHeight)))},drawImage:function(){var r=this,e=r.image.dom;e&&(r.image.clearEdges||(r.context.fillStyle=r.getColor(r.colorLight,-1,-1),r.context.fillRect(r.image.outX,r.image.outY,r.image.outWidth,r.image.outHeight)),r.context.drawImage(r.image.dom,r.image.x,r.image.y,r.image.width,r.image.height))},isDark:function(r,e){var t=this,n=t.image;return r>=0&&r<t.count&&e>=0&&e<t.count&&!(n.cell1&&n.cell2&&r>=n.cell1.row&&r<=n.cell2.row&&e>=n.cell1.col&&e<=n.cell2.col)?t.qrcode.isDark(r,e):!1},draw:function(){function r(r,e,t,n,o){o?a.arcTo(r,e,t,n,o):(a.lineTo(r,e),a.lineTo(t,n))}function e(e){function t(t,n){var i=o.getTile(t,n),u=i.width,f=i.height,l=i.x,c=i.y,g=o.getColor(o.colorDark,t,n),h=o.getColor(o.colorLight,t,n);e?(a.fillStyle=h,a.fillRect(l,c,u,f),o.isDark(t,n)&&(a.fillStyle=g,a.beginPath(),a.moveTo(l+.5*u,c),r(l+u,c,l+u,c+.5*f,e),r(l+u,c+f,l+.5*u,c+f,e),r(l,c+f,l,c+.5*f,e),r(l,c,l+.5*u,c,e),a.closePath(),a.fill())):(a.fillStyle=g,a.fillRect(l,c,u,f))}var n,i;for(n=0;n<o.count;n++)for(i=0;i<o.count;i++)t(n,i)}function t(e,t,n,o,i,u,f){a.beginPath(),a.moveTo(e,t),r(n,o,i,u,f),a.lineTo(n,o),a.lineTo(e,t),a.closePath(),a.fill()}function n(e){function n(n,i){var u=o.getTile(n,i),f=u.width,l=u.height,c=u.x,g=u.y,h=o.getColor(o.colorDark,n,i),s=o.getColor(o.colorLight,n,i),v=[0,0,0,0];o.isDark(n-1,i)&&(v[0]++,v[1]++),o.isDark(n+1,i)&&(v[2]++,v[3]++),o.isDark(n,i-1)&&(v[0]++,v[3]++),o.isDark(n,i+1)&&(v[1]++,v[2]++),a.fillStyle=s,a.fillRect(c,g,f,l),a.fillStyle=h,o.isDark(n,i)?(o.isDark(n-1,i-1)&&v[0]++,o.isDark(n-1,i+1)&&v[1]++,o.isDark(n+1,i+1)&&v[2]++,o.isDark(n+1,i-1)&&v[3]++,a.beginPath(),a.moveTo(c+.5*f,g),r(c+f,g,c+f,g+.5*l,v[1]?0:e),r(c+f,g+l,c+.5*f,g+l,v[2]?0:e),r(c,g+l,c,g+.5*l,v[3]?0:e),r(c,g,c+.5*f,g,v[0]?0:e),a.closePath(),a.fill()):(2==v[0]&&t(c,g+.5*l,c,g,c+.5*f,g,e),2==v[1]&&t(c+.5*f,g,c+f,g,c+f,g+.5*l,e),2==v[2]&&t(c+f,g+.5*l,c+f,g+l,c+.5*f,g+l,e),2==v[3]&&t(c+.5*f,g+l,c,g+l,c,g+.5*l,e))}var i,u;for(i=0;i<o.count;i++)for(u=0;u<o.count;u++)n(i,u)}var o=this,a=o.context,i=o.effect.value*o.cellSize;switch(o.effect.key){case"liquid":n(i);break;case"round":e(i);break;default:e(0)}o.drawImage()},appendTo:function(r){r.appendChild(this.canvas)}},window.QRCanvas=n}({},function(){return this}());